{"title":"SpringDataRedis","uid":"e734ef48d2ce2470a46681dcf2eb2449","slug":"Redis-Learning-03-SpringDataRedis","date":"2023-05-10T13:05:27.000Z","updated":"2024-03-18T08:31:23.212Z","comments":true,"path":"api/articles/Redis-Learning-03-SpringDataRedis.json","keywords":"Code, Learning, Backend, Frontend","cover":"/img/redis.jpg","content":"<h1 id=\"redis的java客户端\"><a class=\"markdownIt-Anchor\" href=\"#redis的java客户端\"></a> Redis的Java客户端</h1>\n<p>Redis的客户端可以在<a href=\"https://redis.io/docs/clients/\">Redis官网</a>找到，推荐的客户端包括：</p>\n<ul>\n<li>Jedis：以Redis命令作为方法名称，学习成本低，简单实用。但是Jedis实例是<strong>线程不安全</strong>的，<strong>多线程环境下需要基于连接池来使用</strong></li>\n<li>Lettuce：Lettuce是基于Netty实现的，支持同步、异步和响应式编程方式，并且是线程安全的。支持Redis的哨兵模式、集群模式和管道模式</li>\n<li>Redisson：是在Redis基础上实现了分布式的可伸缩的java数据结构，例如Map、Queue等，而且支持跨进程的同步机制：Lock、Semaphore等待，比较适合用来实现特殊的功能需求</li>\n</ul>\n<h2 id=\"jedis\"><a class=\"markdownIt-Anchor\" href=\"#jedis\"></a> Jedis</h2>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p><a href=\"https://github.com/redis/jedis\">Jedis官网</a></p></blockquote>\n<h3 id=\"jedis快速入门\"><a class=\"markdownIt-Anchor\" href=\"#jedis快速入门\"></a> Jedis快速入门</h3>\n<h4 id=\"导入依赖\"><a class=\"markdownIt-Anchor\" href=\"#导入依赖\"></a> 导入依赖</h4>\n<figure class=\"shiki xml\"><div class='codeblock'><div class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></div><div class=\"code\"><pre class=\"shiki One Dark Pro\"><code><span class=\"line\"><span style=\"color: #7F848E\">&lt;!--jedis--&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E06C75\">dependency</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    &lt;</span><span style=\"color: #E06C75\">groupId</span><span style=\"color: #ABB2BF\">&gt;redis.clients&lt;/</span><span style=\"color: #E06C75\">groupId</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    &lt;</span><span style=\"color: #E06C75\">artifactId</span><span style=\"color: #ABB2BF\">&gt;jedis&lt;/</span><span style=\"color: #E06C75\">artifactId</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    &lt;</span><span style=\"color: #E06C75\">version</span><span style=\"color: #ABB2BF\">&gt;4.3.1&lt;/</span><span style=\"color: #E06C75\">version</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">&lt;/</span><span style=\"color: #E06C75\">dependency</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E06C75\">dependency</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    &lt;</span><span style=\"color: #E06C75\">groupId</span><span style=\"color: #ABB2BF\">&gt;org.junit.jupiter&lt;/</span><span style=\"color: #E06C75\">groupId</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    &lt;</span><span style=\"color: #E06C75\">artifactId</span><span style=\"color: #ABB2BF\">&gt;junit-jupiter&lt;/</span><span style=\"color: #E06C75\">artifactId</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    &lt;</span><span style=\"color: #E06C75\">version</span><span style=\"color: #ABB2BF\">&gt;5.9.2&lt;/</span><span style=\"color: #E06C75\">version</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    &lt;</span><span style=\"color: #E06C75\">scope</span><span style=\"color: #ABB2BF\">&gt;test&lt;/</span><span style=\"color: #E06C75\">scope</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">&lt;/</span><span style=\"color: #E06C75\">dependency</span><span style=\"color: #ABB2BF\">&gt;</span></span></code></pre></div></div></figure>\n<h4 id=\"建立连接\"><a class=\"markdownIt-Anchor\" href=\"#建立连接\"></a> 建立连接</h4>\n<figure class=\"shiki java\"><div class='codeblock'><div class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></div><div class=\"code\"><pre class=\"shiki One Dark Pro\"><code><span class=\"line\"><span style=\"color: #C678DD\">private</span><span style=\"color: #E06C75\"> </span><span style=\"color: #E5C07B\">Jedis</span><span style=\"color: #E06C75\"> jedis</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">@</span><span style=\"color: #E5C07B\">BeforeEach</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">void</span><span style=\"color: #E06C75\"> </span><span style=\"color: #61AFEF; font-weight: bold\">setUp</span><span style=\"color: #E06C75\">() {</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #7F848E\">// 1.建立连接</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    jedis </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #E06C75\"> </span><span style=\"color: #C678DD\">new</span><span style=\"color: #E06C75\"> </span><span style=\"color: #61AFEF; font-weight: bold\">Jedis</span><span style=\"color: #E06C75\">(</span><span style=\"color: #98C379\">&quot;127.0.0.1&quot;</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #E06C75\"> </span><span style=\"color: #D19A66\">6379</span><span style=\"color: #E06C75\">)</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #7F848E\">// 2.设置密码</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #7F848E\">//jedis.auth(&quot;&quot;);</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #7F848E\">// 3.选择库</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #E5C07B\">jedis</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">select</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">}</span></span></code></pre></div></div></figure>\n<h4 id=\"测试\"><a class=\"markdownIt-Anchor\" href=\"#测试\"></a> 测试</h4>\n<figure class=\"shiki java\"><div class='codeblock'><div class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></div><div class=\"code\"><pre class=\"shiki One Dark Pro\"><code><span class=\"line\"><span style=\"color: #ABB2BF\">@</span><span style=\"color: #E5C07B\">Test</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">void</span><span style=\"color: #E06C75\"> </span><span style=\"color: #61AFEF; font-weight: bold\">testString</span><span style=\"color: #E06C75\">() {</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #7F848E\">// 存入</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #E5C07B\">String</span><span style=\"color: #E06C75\"> result </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #E06C75\"> </span><span style=\"color: #E5C07B\">jedis</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">set</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;name&quot;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #98C379\">&quot;Snow San&quot;</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #E5C07B\">System</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E5C07B\">out</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">println</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;result = &quot;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> result);</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #7F848E\">// 获取</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #E5C07B\">String</span><span style=\"color: #E06C75\"> name </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #E06C75\"> </span><span style=\"color: #E5C07B\">jedis</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">get</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;name&quot;</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #E5C07B\">System</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E5C07B\">out</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">println</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;name = &quot;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> name);</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">}</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">@</span><span style=\"color: #E5C07B\">Test</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">void</span><span style=\"color: #E06C75\"> </span><span style=\"color: #61AFEF; font-weight: bold\">testHash</span><span style=\"color: #E06C75\">() {</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #7F848E\">// 插入</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #E5C07B\">jedis</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">hset</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;user:1&quot;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #98C379\">&quot;name&quot;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #98C379\">&quot;Snow San&quot;</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #E5C07B\">jedis</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">hset</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;user:1&quot;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #98C379\">&quot;age&quot;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #98C379\">&quot;18&quot;</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #7F848E\">// 获取</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #E5C07B\">Map</span><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E5C07B\">String</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #E06C75\"> </span><span style=\"color: #E5C07B\">String</span><span style=\"color: #ABB2BF\">&gt;</span><span style=\"color: #E06C75\"> map </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #E06C75\"> </span><span style=\"color: #E5C07B\">jedis</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">hgetAll</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;user:1&quot;</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #E5C07B\">System</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E5C07B\">out</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">println</span><span style=\"color: #ABB2BF\">(map);</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">}</span></span></code></pre></div></div></figure>\n<h4 id=\"释放资源\"><a class=\"markdownIt-Anchor\" href=\"#释放资源\"></a> 释放资源</h4>\n<figure class=\"shiki java\"><div class='codeblock'><div class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></div><div class=\"code\"><pre class=\"shiki One Dark Pro\"><code><span class=\"line\"><span style=\"color: #ABB2BF\">@</span><span style=\"color: #E5C07B\">AfterEach</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">void</span><span style=\"color: #E06C75\"> </span><span style=\"color: #61AFEF; font-weight: bold\">destroy</span><span style=\"color: #E06C75\">() {</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #C678DD\">if</span><span style=\"color: #E06C75\"> (jedis </span><span style=\"color: #56B6C2\">!=</span><span style=\"color: #E06C75\"> </span><span style=\"color: #D19A66\">null</span><span style=\"color: #E06C75\">) {</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">        </span><span style=\"color: #E5C07B\">jedis</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">close</span><span style=\"color: #ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    }</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">}</span></span></code></pre></div></div></figure>\n<h3 id=\"jedis连接池\"><a class=\"markdownIt-Anchor\" href=\"#jedis连接池\"></a> Jedis连接池</h3>\n<p>Jedis本身是<strong>线程不安全</strong>的，并且频繁的创建和销毁连接会有性能损耗，因此推荐使用Jedis连接池~</p>\n<figure class=\"shiki java\"><div class='codeblock'><div class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></div><div class=\"code\"><pre class=\"shiki One Dark Pro\"><code><span class=\"line\"><span style=\"color: #C678DD\">import</span><span style=\"color: #E06C75\"> </span><span style=\"color: #E5C07B\">redis.clients.jedis.*</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C678DD\">public</span><span style=\"color: #E06C75\"> </span><span style=\"color: #C678DD\">class</span><span style=\"color: #E06C75\"> </span><span style=\"color: #E5C07B\">JedisConnectionFactory</span><span style=\"color: #E06C75\"> </span><span style=\"color: #ABB2BF\">{</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #C678DD\">private</span><span style=\"color: #E06C75\"> </span><span style=\"color: #C678DD\">static</span><span style=\"color: #E06C75\"> </span><span style=\"color: #E5C07B\">JedisPool</span><span style=\"color: #E06C75\"> jedisPool</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #C678DD\">static</span><span style=\"color: #E06C75\"> {</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">        </span><span style=\"color: #7F848E\">// 配置连接池</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">        </span><span style=\"color: #E5C07B\">JedisPoolConfig</span><span style=\"color: #E06C75\"> poolConfig </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #E06C75\"> </span><span style=\"color: #C678DD\">new</span><span style=\"color: #E06C75\"> </span><span style=\"color: #61AFEF; font-weight: bold\">JedisPoolConfig</span><span style=\"color: #E06C75\">()</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">        </span><span style=\"color: #E5C07B\">poolConfig</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">setMaxTotal</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #D19A66\">8</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">        </span><span style=\"color: #E5C07B\">poolConfig</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">setMaxIdle</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #D19A66\">8</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">        </span><span style=\"color: #E5C07B\">poolConfig</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">setMinIdle</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">        </span><span style=\"color: #E5C07B\">poolConfig</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">setMaxWaitMillis</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #D19A66\">1000</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">        </span><span style=\"color: #7F848E\">// 创建连接池对象，参数：连接池配置、服务端ip、服务端端口、超时时间、密码</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">        jedisPool </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #E06C75\"> </span><span style=\"color: #C678DD\">new</span><span style=\"color: #E06C75\"> </span><span style=\"color: #61AFEF; font-weight: bold\">JedisPool</span><span style=\"color: #E06C75\">(poolConfig</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #E06C75\"> </span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">                                  </span><span style=\"color: #98C379\">&quot;127.0.0.1&quot;</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #E06C75\"> </span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">                                  </span><span style=\"color: #D19A66\">6379</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #E06C75\"> </span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">                                  </span><span style=\"color: #D19A66\">1000</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #E06C75\"> </span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">                                  </span><span style=\"color: #98C379\">&quot;&quot;</span><span style=\"color: #E06C75\">)</span><span style=\"color: #ABB2BF\">;</span><span style=\"color: #7F848E\">//密码在此（</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    }</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #C678DD\">public</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #C678DD\">static</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #E5C07B\">Jedis</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #61AFEF; font-weight: bold\">getJedis</span><span style=\"color: #ABB2BF\">(){</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">return</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">jedisPool</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">getResource</span><span style=\"color: #ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">}</span></span></code></pre></div></div></figure>\n<h2 id=\"springdataredis客户端\"><a class=\"markdownIt-Anchor\" href=\"#springdataredis客户端\"></a> SpringDataRedis客户端</h2>\n<p><s>接下来就是本次的主角啦！</s></p>\n<p>SpringData是Spring中数据操作的模块，包含对各种数据库的集成，其中对Redis的集成模块就叫做SpringDataRedis，<a href=\"https://spring.io/projects/spring-data-redis\">SpringDataRedis官网</a></p>\n<p>ta的特点如下：</p>\n<ul>\n<li>提供了对不同Redis客户端的整合（Lettuce和Jedis）</li>\n<li>提供了RedisTemplate统一API来操作Redis</li>\n<li>支持Redis的发布订阅模型</li>\n<li>支持Redis哨兵和Redis集群</li>\n<li>支持基于Lettuce的响应式编程</li>\n<li>支持基于JDK、JSON、字符串、Spring对象的数据序列化及反序列化</li>\n<li>支持基于Redis的JDKCollection实现</li>\n</ul>\n<p>SpringDataRedis中提供了RedisTemplate工具类，其中封装了各种对Redis的操作。并且将不同数据类型的操作API封装到了不同的类型中</p>\n<h3 id=\"springdataredis快速入门\"><a class=\"markdownIt-Anchor\" href=\"#springdataredis快速入门\"></a> SpringDataRedis快速入门</h3>\n<h4 id=\"新建一个boot项目\"><a class=\"markdownIt-Anchor\" href=\"#新建一个boot项目\"></a> 新建一个boot项目</h4>\n<p><s>别说你连boot项目都不会建</s></p>\n<h4 id=\"引入依赖\"><a class=\"markdownIt-Anchor\" href=\"#引入依赖\"></a> 引入依赖</h4>\n<p>要引入<code>spring-boot-starter-data-redis</code>,<code>commons-pool2</code>和<code>jackson-databind</code>，不过貌似MVC已经整合了<code>jackson</code>？</p>\n<p><s>懒的话整个<code>lombok</code></s></p>\n<figure class=\"shiki xml\"><div class='codeblock'><div class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></div><div class=\"code\"><pre class=\"shiki One Dark Pro\"><code><span class=\"line\"><span style=\"color: #7F848E\">&lt;!--redis依赖--&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E06C75\">dependency</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">\t&lt;</span><span style=\"color: #E06C75\">groupId</span><span style=\"color: #ABB2BF\">&gt;org.springframework.boot&lt;/</span><span style=\"color: #E06C75\">groupId</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">\t&lt;</span><span style=\"color: #E06C75\">artifactId</span><span style=\"color: #ABB2BF\">&gt;spring-boot-starter-data-redis&lt;/</span><span style=\"color: #E06C75\">artifactId</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">&lt;/</span><span style=\"color: #E06C75\">dependency</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #7F848E\">&lt;!--common-pool--&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E06C75\">dependency</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">\t&lt;</span><span style=\"color: #E06C75\">groupId</span><span style=\"color: #ABB2BF\">&gt;org.apache.commons&lt;/</span><span style=\"color: #E06C75\">groupId</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">\t&lt;</span><span style=\"color: #E06C75\">artifactId</span><span style=\"color: #ABB2BF\">&gt;commons-pool2&lt;/</span><span style=\"color: #E06C75\">artifactId</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">&lt;/</span><span style=\"color: #E06C75\">dependency</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #7F848E\">&lt;!--Jackson依赖--&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E06C75\">dependency</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">\t&lt;</span><span style=\"color: #E06C75\">groupId</span><span style=\"color: #ABB2BF\">&gt;com.fasterxml.jackson.core&lt;/</span><span style=\"color: #E06C75\">groupId</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">\t&lt;</span><span style=\"color: #E06C75\">artifactId</span><span style=\"color: #ABB2BF\">&gt;jackson-databind&lt;/</span><span style=\"color: #E06C75\">artifactId</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">&lt;/</span><span style=\"color: #E06C75\">dependency</span><span style=\"color: #ABB2BF\">&gt;</span></span></code></pre></div></div></figure>\n<h4 id=\"配置redis\"><a class=\"markdownIt-Anchor\" href=\"#配置redis\"></a> 配置Redis</h4>\n<p>说到boot果然就是yaml呢~~（笑）~~</p>\n<figure class=\"shiki yaml\"><div class='codeblock'><div class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></div><div class=\"code\"><pre class=\"shiki One Dark Pro\"><code><span class=\"line\"><span style=\"color: #E06C75\">spring</span><span style=\"color: #ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  </span><span style=\"color: #E06C75\">data</span><span style=\"color: #ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E06C75\">redis</span><span style=\"color: #ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">      </span><span style=\"color: #E06C75\">host</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #D19A66\">0.0.0.0</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">      </span><span style=\"color: #E06C75\">port</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #D19A66\">6379</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">      </span><span style=\"color: #E06C75\">lettuce</span><span style=\"color: #ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">pool</span><span style=\"color: #ABB2BF\">:</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">          </span><span style=\"color: #E06C75\">max-active</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #D19A66\">8</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">          </span><span style=\"color: #E06C75\">max-idle</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #D19A66\">8</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">          </span><span style=\"color: #E06C75\">min-idle</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #D19A66\">0</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">          </span><span style=\"color: #E06C75\">max-wait</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #98C379\">1000ms</span></span></code></pre></div></div></figure>\n<h4 id=\"注入redistemplate\"><a class=\"markdownIt-Anchor\" href=\"#注入redistemplate\"></a> 注入RedisTemplate</h4>\n<figure class=\"shiki java\"><div class='codeblock'><div class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></div><div class=\"code\"><pre class=\"shiki One Dark Pro\"><code><span class=\"line\"><span style=\"color: #ABB2BF\">@</span><span style=\"color: #E5C07B\">Autowired</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">private</span><span style=\"color: #E06C75\"> </span><span style=\"color: #E5C07B\">RedisTemplate</span><span style=\"color: #E06C75\"> redisTemplate</span><span style=\"color: #ABB2BF\">;</span></span></code></pre></div></div></figure>\n<h4 id=\"测试-2\"><a class=\"markdownIt-Anchor\" href=\"#测试-2\"></a> 测试！</h4>\n<figure class=\"shiki java\"><div class='codeblock'><div class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></div><div class=\"code\"><pre class=\"shiki One Dark Pro\"><code><span class=\"line\"><span style=\"color: #ABB2BF\">@</span><span style=\"color: #E5C07B\">Test</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">void</span><span style=\"color: #E06C75\"> </span><span style=\"color: #61AFEF; font-weight: bold\">testString</span><span style=\"color: #E06C75\">() {</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #7F848E\">// 写入</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #E5C07B\">redisTemplate</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">opsForValue</span><span style=\"color: #ABB2BF\">().</span><span style=\"color: #61AFEF; font-weight: bold\">set</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;name&quot;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #98C379\">&quot;Snow San&quot;</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #7F848E\">// 获取</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #E5C07B\">Object</span><span style=\"color: #E06C75\"> name </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #E06C75\"> </span><span style=\"color: #E5C07B\">stringRedisTemplate</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">opsForValue</span><span style=\"color: #ABB2BF\">().</span><span style=\"color: #61AFEF; font-weight: bold\">get</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;name&quot;</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #E5C07B\">System</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E5C07B\">out</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">println</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;name = &quot;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> name);</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">}</span></span></code></pre></div></div></figure>\n<h3 id=\"自定义序列化~~白雪~~\"><a class=\"markdownIt-Anchor\" href=\"#自定义序列化~~白雪~~\"></a> 自定义序列化~~（白雪）~~</h3>\n<p>RedisTemplate可以接收任意<code>Object</code>作为值写入Redis,但在写入前会把<code>Object</code>序列化为字节形式，默认是采用JDK序列化，缺点是：</p>\n<ul>\n<li>可读性差</li>\n<li>内存占用较大</li>\n</ul>\n<p>因此可以自定义RedisTemplate的序列化方式，采用JSON序列化来代替默认的JDK序列化方式</p>\n<figure class=\"shiki java\"><div class='codeblock'><div class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></div><div class=\"code\"><pre class=\"shiki One Dark Pro\"><code><span class=\"line\"><span style=\"color: #ABB2BF\">@</span><span style=\"color: #E5C07B\">Configuration</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">public</span><span style=\"color: #E06C75\"> </span><span style=\"color: #C678DD\">class</span><span style=\"color: #E06C75\"> </span><span style=\"color: #E5C07B\">RedisConfig</span><span style=\"color: #E06C75\"> </span><span style=\"color: #ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #ABB2BF\">@</span><span style=\"color: #E5C07B\">Bean</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #C678DD\">public</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #E5C07B\">RedisTemplate</span><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E5C07B\">String</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #E5C07B\">Object</span><span style=\"color: #ABB2BF\">&gt;</span><span style=\"color: #61AFEF\"> </span><span style=\"color: #61AFEF; font-weight: bold\">redisTemplate</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">RedisConnectionFactory</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">connectionFactory</span><span style=\"color: #ABB2BF\">){</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E5C07B\">RedisTemplate</span><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E5C07B\">String</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Object</span><span style=\"color: #ABB2BF\">&gt; </span><span style=\"color: #E06C75\">template</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">new</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">RedisTemplate</span><span style=\"color: #ABB2BF\">&lt;&gt;();</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E5C07B\">template</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">setConnectionFactory</span><span style=\"color: #ABB2BF\">(connectionFactory);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #7F848E\">// 创建JSON序列化工具</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E5C07B\">GenericJackson2JsonRedisSerializer</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">jsonRedisSerializer</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #C678DD\">new</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF; font-weight: bold\">GenericJackson2JsonRedisSerializer</span><span style=\"color: #ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #7F848E\">// 设置Key的序列化</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E5C07B\">template</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">setKeySerializer</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">RedisSerializer</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">string</span><span style=\"color: #ABB2BF\">());</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E5C07B\">template</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">setHashKeySerializer</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">RedisSerializer</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">string</span><span style=\"color: #ABB2BF\">());</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #7F848E\">// 设置Value的序列化</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E5C07B\">template</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">setValueSerializer</span><span style=\"color: #ABB2BF\">(jsonRedisSerializer);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E5C07B\">template</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">setHashValueSerializer</span><span style=\"color: #ABB2BF\">(jsonRedisSerializer);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #7F848E\">// 返回</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">return</span><span style=\"color: #ABB2BF\"> template;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">}</span></span></code></pre></div></div></figure>\n<p>JSON序列化在查询时还能自动把JSON反序列化为Java对象，注意<code>@class</code>字段，ta会带来额外的内存开销</p>\n<h3 id=\"stringredistemplate\"><a class=\"markdownIt-Anchor\" href=\"#stringredistemplate\"></a> StringRedisTemplate</h3>\n<p>为了节省内存空间，我们可以不使用JSON序列化器来处理value，而是统一使用String序列化器，要求只能存储String类型的key和value。</p>\n<p>不过当需要存储Java对象时，必须手动完成对象的序列化和反序列化</p>\n<figure class=\"shiki java\"><div class='codeblock'><div class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></div><div class=\"code\"><pre class=\"shiki One Dark Pro\"><code><span class=\"line\"><span style=\"color: #ABB2BF\">@</span><span style=\"color: #E5C07B\">Autowired</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">private</span><span style=\"color: #E06C75\"> </span><span style=\"color: #E5C07B\">StringRedisTemplate</span><span style=\"color: #E06C75\"> stringRedisTemplate</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">@</span><span style=\"color: #E5C07B\">Test</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">void</span><span style=\"color: #E06C75\"> </span><span style=\"color: #61AFEF; font-weight: bold\">testString</span><span style=\"color: #E06C75\">() {</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #7F848E\">// 写入</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #E5C07B\">stringRedisTemplate</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">opsForValue</span><span style=\"color: #ABB2BF\">().</span><span style=\"color: #61AFEF; font-weight: bold\">set</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;verify:phone:11111111&quot;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #98C379\">&quot;123456&quot;</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #7F848E\">// 获取</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #E5C07B\">Object</span><span style=\"color: #E06C75\"> name </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #E06C75\"> </span><span style=\"color: #E5C07B\">stringRedisTemplate</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">opsForValue</span><span style=\"color: #ABB2BF\">().</span><span style=\"color: #61AFEF; font-weight: bold\">get</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;name&quot;</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #E5C07B\">System</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E5C07B\">out</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">println</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;name = &quot;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> name);</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C678DD\">private</span><span style=\"color: #E06C75\"> </span><span style=\"color: #C678DD\">static</span><span style=\"color: #E06C75\"> </span><span style=\"color: #C678DD\">final</span><span style=\"color: #E06C75\"> </span><span style=\"color: #E5C07B\">ObjectMapper</span><span style=\"color: #E06C75\"> mapper </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #E06C75\"> </span><span style=\"color: #C678DD\">new</span><span style=\"color: #E06C75\"> </span><span style=\"color: #61AFEF; font-weight: bold\">ObjectMapper</span><span style=\"color: #E06C75\">()</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">@</span><span style=\"color: #E5C07B\">Test</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">void</span><span style=\"color: #E06C75\"> </span><span style=\"color: #61AFEF; font-weight: bold\">testSaveUser</span><span style=\"color: #E06C75\">() throws JsonProcessingException {</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #7F848E\">// 创建对象</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #E5C07B\">User</span><span style=\"color: #E06C75\"> user </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #E06C75\"> </span><span style=\"color: #C678DD\">new</span><span style=\"color: #E06C75\"> </span><span style=\"color: #61AFEF; font-weight: bold\">User</span><span style=\"color: #E06C75\">(</span><span style=\"color: #98C379\">&quot;Snow&quot;</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #E06C75\"> </span><span style=\"color: #D19A66\">18</span><span style=\"color: #E06C75\">)</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #7F848E\">// 手动序列化</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #E5C07B\">String</span><span style=\"color: #E06C75\"> json </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #E06C75\"> </span><span style=\"color: #E5C07B\">mapper</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">writeValueAsString</span><span style=\"color: #ABB2BF\">(user);</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #7F848E\">// 写入</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #E5C07B\">stringRedisTemplate</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">opsForValue</span><span style=\"color: #ABB2BF\">().</span><span style=\"color: #61AFEF; font-weight: bold\">set</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;user:1&quot;</span><span style=\"color: #ABB2BF\">, json);</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #7F848E\">// 获取</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #E5C07B\">String</span><span style=\"color: #E06C75\"> jsonUser </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #E06C75\"> </span><span style=\"color: #E5C07B\">stringRedisTemplate</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">opsForValue</span><span style=\"color: #ABB2BF\">().</span><span style=\"color: #61AFEF; font-weight: bold\">get</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;user:1&quot;</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #7F848E\">// 手动反序列化</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #E5C07B\">User</span><span style=\"color: #E06C75\"> user1 </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #E06C75\"> </span><span style=\"color: #E5C07B\">mapper</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">readValue</span><span style=\"color: #ABB2BF\">(jsonUser, </span><span style=\"color: #E5C07B\">User</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E5C07B\">class</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">    </span><span style=\"color: #E5C07B\">System</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E5C07B\">out</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF; font-weight: bold\">println</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;user1 = &quot;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> user1);</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">}</span></span></code></pre></div></div></figure>\n","text":" Redis的Java客户端 Redis的客户端可以在Redis官网找到，推荐的客户端包括： Jedis：以Redis命令作为方法名称，学习成本低，简单实用。但...","permalink":"/post/Redis-Learning-03-SpringDataRedis","photos":[],"count_time":{"symbolsCount":"6.2k","symbolsTime":"6 mins."},"categories":[{"name":"Redis","slug":"Redis","count":4,"path":"api/categories/Redis.json"}],"tags":[{"name":"coding","slug":"coding","count":19,"path":"api/tags/coding.json"},{"name":"Redis","slug":"Redis","count":4,"path":"api/tags/Redis.json"},{"name":"Java","slug":"Java","count":2,"path":"api/tags/Java.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#redis%E7%9A%84java%E5%AE%A2%E6%88%B7%E7%AB%AF\"><span class=\"toc-text\"> Redis的Java客户端</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#jedis\"><span class=\"toc-text\"> Jedis</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#jedis%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8\"><span class=\"toc-text\"> Jedis快速入门</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%AF%BC%E5%85%A5%E4%BE%9D%E8%B5%96\"><span class=\"toc-text\"> 导入依赖</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%BB%BA%E7%AB%8B%E8%BF%9E%E6%8E%A5\"><span class=\"toc-text\"> 建立连接</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%B5%8B%E8%AF%95\"><span class=\"toc-text\"> 测试</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E9%87%8A%E6%94%BE%E8%B5%84%E6%BA%90\"><span class=\"toc-text\"> 释放资源</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#jedis%E8%BF%9E%E6%8E%A5%E6%B1%A0\"><span class=\"toc-text\"> Jedis连接池</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#springdataredis%E5%AE%A2%E6%88%B7%E7%AB%AF\"><span class=\"toc-text\"> SpringDataRedis客户端</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#springdataredis%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8\"><span class=\"toc-text\"> SpringDataRedis快速入门</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%96%B0%E5%BB%BA%E4%B8%80%E4%B8%AAboot%E9%A1%B9%E7%9B%AE\"><span class=\"toc-text\"> 新建一个boot项目</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%BC%95%E5%85%A5%E4%BE%9D%E8%B5%96\"><span class=\"toc-text\"> 引入依赖</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AEredis\"><span class=\"toc-text\"> 配置Redis</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%B3%A8%E5%85%A5redistemplate\"><span class=\"toc-text\"> 注入RedisTemplate</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%B5%8B%E8%AF%95-2\"><span class=\"toc-text\"> 测试！</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BA%8F%E5%88%97%E5%8C%96~~%E7%99%BD%E9%9B%AA~~\"><span class=\"toc-text\"> 自定义序列化~~（白雪）~~</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#stringredistemplate\"><span class=\"toc-text\"> StringRedisTemplate</span></a></li></ol></li></ol></li></ol>","author":{"name":"Ivan Snow","slug":"blog-author","avatar":"https://ivansnow02.github.io/img/avatar.png","link":"/","description":"目前就读于某大学的计算机科学与技术专业，在学习后端与CV中","socials":{"github":"https://github.com/ivansnow02","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"Redis实战——黑马点评","uid":"9ae1faec43a5cc6a5b23d428a7b7e9ed","slug":"heimadianping","date":"2023-05-12T09:47:54.000Z","updated":"2024-03-17T05:25:10.332Z","comments":true,"path":"api/articles/heimadianping.json","keywords":"Code, Learning, Backend, Frontend","cover":"/img/redis.jpg","text":"就是黑马程序员的Redis教程里的黑马点评的项目，前面就不讲了，直接开始正题。 基于Session实现登录流程 分为三个步骤： 发送验证码 短信验证码登录、注册...","permalink":"/post/heimadianping","photos":[],"count_time":{"symbolsCount":"8.9k","symbolsTime":"8 mins."},"categories":[{"name":"Redis","slug":"Redis","count":4,"path":"api/categories/Redis.json"}],"tags":[{"name":"coding","slug":"coding","count":19,"path":"api/tags/coding.json"},{"name":"Redis","slug":"Redis","count":4,"path":"api/tags/Redis.json"},{"name":"Java","slug":"Java","count":2,"path":"api/tags/Java.json"},{"name":"Spring","slug":"Spring","count":1,"path":"api/tags/Spring.json"}],"author":{"name":"Ivan Snow","slug":"blog-author","avatar":"https://ivansnow02.github.io/img/avatar.png","link":"/","description":"目前就读于某大学的计算机科学与技术专业，在学习后端与CV中","socials":{"github":"https://github.com/ivansnow02","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"习近平新时代中国特色社会主义思想概论","uid":"3d9d8863a52feda63ba7c666e672315d","slug":"XJP","date":"2023-05-10T10:31:09.000Z","updated":"2024-03-17T09:33:42.220Z","comments":true,"path":"api/articles/XJP.json","keywords":"Code, Learning, Backend, Frontend","cover":"/img/R.jpg","text":" 第一讲 马克思主义中国化新飞跃 一、习近平新时代中国特色社会主义思想如何创立的 时代背景：\"两个大局\"同步交织 两个大局：中华民族伟大复兴的战略全局；世界百年...","permalink":"/post/XJP","photos":[],"count_time":{"symbolsCount":"74k","symbolsTime":"1:07"},"categories":[{"name":"trash","slug":"trash","count":3,"path":"api/categories/trash.json"}],"tags":[{"name":"learning","slug":"learning","count":8,"path":"api/tags/learning.json"},{"name":"trash","slug":"trash","count":3,"path":"api/tags/trash.json"}],"author":{"name":"Ivan Snow","slug":"blog-author","avatar":"https://ivansnow02.github.io/img/avatar.png","link":"/","description":"目前就读于某大学的计算机科学与技术专业，在学习后端与CV中","socials":{"github":"https://github.com/ivansnow02","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}